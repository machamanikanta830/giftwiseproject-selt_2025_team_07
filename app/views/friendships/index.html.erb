<!-- app/views/friendships/index.html.erb -->
<div class="min-h-screen bg-[#f5f5fb] text-gray-900">
  <!-- Flash Messages Container -->
  <div id="flash-messages" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <!-- Back Button -->
  <div class="max-w-6xl mx-auto px-6 pt-8">
    <%= link_to dashboard_path, class: "inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
      <span class="font-medium">Back to Dashboard</span>
    <% end %>
  </div>

  <!-- Main Content -->
  <main class="max-w-6xl mx-auto px-6 pt-6 pb-16">
    <h1 class="text-4xl font-semibold mb-2">Friends</h1>
    <p class="text-gray-500 mb-8">Manage your friend connections</p>

    <!-- Pending Requests Section -->
    <% if @pending_requests.any? %>
      <section class="mb-8">
        <div class="bg-white rounded-3xl p-6 border border-yellow-200 shadow-sm">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 rounded-full bg-yellow-100 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-yellow-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 8v4M12 16h.01"></path>
              </svg>
            </div>
            <div>
              <h2 class="text-xl font-semibold">Pending Requests</h2>
              <p id="pending_count" class="text-sm text-gray-500"><%= pluralize(@pending_requests.count, "friend request") %> waiting</p>
            </div>
          </div>

          <div class="space-y-3" id="pending_requests_list">
            <% @pending_requests.each do |friendship| %>
              <%= render 'friendships/pending_request', friendship: friendship %>
            <% end %>
          </div>
        </div>
      </section>
    <% end %>

    <!-- Two Column Layout -->
    <div class="grid md:grid-cols-2 gap-6">
      <!-- Your Friends -->
      <section>
        <div class="bg-white rounded-3xl p-6 border border-green-200 shadow-sm">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
            </div>
            <div>
              <h2 class="text-xl font-semibold">Your Friends</h2>
              <p id="friends_count" class="text-sm text-gray-500"><%= pluralize(@friends.count, "friend") %></p>
            </div>
          </div>

          <% if @friends.any? %>
            <div class="space-y-3" id="friends_list">
              <% @friends.each do |friend| %>
                <%= render 'friendships/friend_card', friend: friend %>
              <% end %>
            </div>
          <% else %>
            <div class="text-center py-8">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-gray-300 mx-auto mb-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              <p class="text-gray-500">No friends yet</p>
              <p class="text-sm text-gray-400 mt-1">Add friends from the list â†’</p>
            </div>
          <% end %>
        </div>
      </section>

      <!-- Add Friends -->
      <section>
        <div class="bg-white rounded-3xl p-6 border border-[#e9d5ff] shadow-sm">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-10 h-10 rounded-full bg-[#f4e6ff] flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-[#a855f7]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="8.5" cy="7" r="4"></circle>
                <line x1="20" y1="8" x2="20" y2="14"></line>
                <line x1="23" y1="11" x2="17" y2="11"></line>
              </svg>
            </div>
            <div>
              <h2 class="text-xl font-semibold">Add Friends</h2>
              <p class="text-sm text-gray-500"><%= pluralize(@potential_friends.count, "user") %> available</p>
            </div>
          </div>

          <% if @potential_friends.any? %>
            <div class="space-y-3" id="potential_friends_list">
              <% @potential_friends.each do |user| %>
                <div id="potential_friend_<%= user.id %>" class="flex items-center justify-between p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition">
                  <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-[#f4e6ff] flex items-center justify-center">
                      <span class="text-[#a855f7] font-semibold text-sm"><%= user.name.first.upcase %></span>
                    </div>
                    <div>
                      <p class="font-medium text-gray-900"><%= user.name %></p>
                      <p class="text-xs text-gray-500"><%= user.email %></p>
                    </div>
                  </div>
                  <%= button_to "Add Friend",
                                friendships_path(friend_id: user.id),
                                method: :post,
                                class: "px-4 py-2 rounded-full bg-[#a855f7] text-white text-sm font-medium hover:bg-[#9333ea] transition",
                                data: { turbo_stream: true } %>
                </div>
              <% end %>
            </div>
          <% else %>
            <div class="text-center py-8">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-gray-300 mx-auto mb-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="8.5" cy="7" r="4"></circle>
                <line x1="20" y1="8" x2="20" y2="14"></line>
                <line x1="23" y1="11" x2="17" y2="11"></line>
              </svg>
              <p class="text-gray-500">No more users to add</p>
              <p class="text-sm text-gray-400 mt-1">You've sent requests to everyone!</p>
            </div>
          <% end %>
        </div>
      </section>
    </div>
  </main>
</div>
