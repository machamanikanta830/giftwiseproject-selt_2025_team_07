<!DOCTYPE html>
<html>
<head>
  <title>Giftwiseproject</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>

  <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>

  <%= javascript_importmap_tags %>
</head>

<body class="bg-[#f5f5fb] text-gray-900">
<% unless controller_name == "sessions" %>
  <% if notice.present? || alert.present? %>
    <div id="flash-message"
         class="fixed top-4 left-1/2 transform -translate-x-1/2
                z-50 px-6 py-3 rounded-xl shadow-lg text-center text-sm font-medium
                transition-all duration-700 ease-in-out
                <%= notice.present? ? 'bg-green-100 border border-green-300 text-green-800' : 'bg-red-100 border border-red-300 text-red-800' %>">
      <%= notice || alert %>
    </div>
  <% end %>
<% end %>


<%= javascript_tag do %>
  document.addEventListener("turbo:load", () => {
  const flash = document.getElementById("flash-message");
  if (flash) {
  setTimeout(() => {
  flash.classList.add("opacity-0", "scale-90");
  }, 2500);

  setTimeout(() => {
  flash.remove();
  }, 3500);
  }
  });
<% end %>

<!-- Main page content -->
<%= yield %>

<!-- Modal Blur Script MUST COME AFTER yield -->
<script>
    document.addEventListener("turbo:frame-load", function(event) {
        if (event.target.id === "modal") {
            const page = document.getElementById("page-wrapper");
            if (page) {
                page.classList.add("blur-sm", "opacity-60", "transition");
            }
        }
    });

    document.addEventListener("turbo:before-frame-render", function(event) {
        if (event.target.id === "modal") {
            const page = document.getElementById("page-wrapper");
            if (page) {
                page.classList.remove("blur-sm", "opacity-60");
            }
        }
    });
</script>

</body>
</html>

